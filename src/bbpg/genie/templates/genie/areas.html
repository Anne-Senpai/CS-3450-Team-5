{% extends 'genie/base.html' %}
{% load static %}
{% block title %}Available Spots{% endblock %}
{% block content %}

<h1 class="mb-4">Available Parking Areas</h1>

<p class="lead font-weight-bolder mb-0">{{ event.name }}</p>
<p class="lead mb-1">{{ event.startTime|date:'M d Y h:i A' }} | {{ event.address }}</p>
<a class="" href="{% url 'genie:events' %}"><i class="fa-fw fas fa-arrow-left"></i> select a different event</a>

<p class="lead font-weight-bolder mt-3 mb-0">{{ lot.name }}</p>
<p class="lead mb-1">{{ lot.address }}</p>
<a class="" href="{% url 'genie:lots' %}?event={{ event.pk }}"><i class="fa-fw fas fa-arrow-left"></i> select a different lot</a>

<div class="row mt-5">
	<div class="col"><p><strong>Area</strong></p></div>
    <div class="col"><p><strong>Capacity</strong></p></div>
	<div class="col"><p><strong>Spot Type</strong></p></div>
    <div class="col"><p><strong>Price</strong></p></div>
	<div class="col"><p class="pl-2"><strong>Make Reservation</strong></p></div>
</div>
<hr class="mt-0" />
{% for area in areas %}
<div class="row">
	<div class="col">{{ area.0.areaIdentifier }}</div>
    <div class="col">{{ area.1 }} of {{ area.0.capacity }}</div>
	<div class="col justify-content-center">
		<div>
			<span class="badge badge-pill badge-info mr-2">{{ area.0.type }}</span>
		</div>
	</div>
    <div class="col">${{ area.0.price }}</div>
    <div class="col">&nbsp;
        {% if area.1 < 1 %}
        <strong class="pt-0 text-danger">SOLD OUT</strong>
        {% else %}
        <button type="button" class="pt-0 pl-0 btn btn-link" data-toggle="modal" data-target="#reserve_{{ area.0.pk }}">Reserve</button>
        {% endif %}
    </div>
</div>
<hr class="mt-3" />
{% if area.1 > 0 %}
<div class="modal fade" id="reserve_{{ area.0.pk }}" tabindex="-1" role="dialog" aria-labelledby="reserve_{{ area.0.pk }}" aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content p-4">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel">Reservation Details</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
          <p class="m-0"><strong>Area: </strong>{{ area.0.areaIdentifier }}</p>
          <p class="m-0"><strong>Lot Address: </strong>{{ lot.address }}</p>
          <h3 class="h5 mt-2 text-primary">Event Details</h3>
          <p class="font-weight-bolder mb-0">{{ event.name }}</p>
          <p class="m-0"><strong>Date: </strong>{{ event.startTime|date:'M d Y' }}</p>
          <p class="m-0"><strong>Time: </strong>{{ event.startTime|date:'h:i A' }} - {{ event.endTime|date:'h:i A' }}</p>
          <p class="card-text">{{ event.address }}</p>
          <h3 class="h5 mt-2 text-primary">Payment Details</h3>
          <p class="card-text"><strong>Price:</strong> ${{ area.0.price }}<br /><strong>Current Balance: </strong> $<span id="balance">{{ user.profile.balance }}</span></p>
      </div>
      <div class="modal-footer">
          <a class="btn btn-block btn-outline-success mt-2 mb-3" href="{% url 'genie:make_reservation' %}?event={{ event.pk }}&area={{ area.0.pk }}"><i class="fas fa-fw fa-check"></i> Make Payment</a>
          <button class="btn btn-block btn-outline-danger mt-2 mb-3"><i class="fas fa-fw fa-times"></i> Cancel</button>
      </div>
    </div>
  </div>
</div>
{% endif %}
{% endfor %}


{% endblock %}
